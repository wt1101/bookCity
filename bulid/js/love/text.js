define(["jquery","temp","getUrl","base64"],function(o,i,n){var t=n("chaptersum"),e=window.localStorage,c=n("curchapter")||1*e.getItem("chapterId")||1,r=e.getItem("fontSize")||16;function u(n){n.on("click",function(){return o(".colors").toggle("active"),o(".active").show(),!1})}function s(){o(".b").html(c),e.setItem("chapterId",c),o.ajax({url:"/api/reader",data:{chapterNum:c},dataType:"json",success:function(n){var t,e,c;t=n.jsonp,e=function(n){n=JSON.parse(o.base64().decode(n));i(o(".text").html(),n,".content")},c=document.createElement("script"),window.duokan_fiction_chapter=function(n){e(n),document.head.removeChild(c)},c.src=t,document.head.appendChild(c)}})}o(".content").css("fontSize",1*r),o(".sum").html(t),o(".menu").on("click",function(){o(this).hide()}),o(".content").on("click",function(){o(".menu").show()}),o(".up").on("click",function(){return c=--c<=1?1:c,s(),!1}),o(".down").on("click",function(){return c=t<=++c?t:c,s(),!1}),s(),u(o(".bgcolor")),u(o(".font")),o(".big").on("click",function(){var n=parseInt(o(".content").css("fontSize"));return o(".content").css("fontSize",++n),e.setItem("fontSize",n),!1}),o(".smile").on("click",function(){var n=parseInt(o(".content").css("fontSize"));return o(".content").css("fontSize",--n),e.setItem("fontSize",n),!1}),o(".colors").on("click","em",function(){return o(".content").css("background",o(this).css("background")),!1}),o(".menu-btn").on("click",function(){window.location.href="../detail/menu.html?id="+n("id")+"&active="+c})});