define(["zepto","swiper","text!message/index.html","hand","text!message/strong.html","text!message/limited-time.html","text!message/girl.html","text!message/topics.html","text!message/search.html"],function(o,t,a,n,s,c,l,r,i){function m(t,a){var i=5*t,e=5*t+5,s=a.slice(i,e);return s.map(function(t,a){t.count=a+1}),s}function d(t,a,i,e){var s=n.compile(t);e?o(i).append(s(a)):o(i).html(s(a))}new t(".swiper-container",{autoplay:!0,loop:!0,delay:1e3}),o(".header span").on("click",function(){o(this).addClass("active").siblings().removeClass("active");var t=o(this).index()-1;o(".content").css({transform:"translate(-"+100*t+"%)"})}),o.ajax({url:"/api/index",dataType:"json",success:function(i){d(a,i.items[1],".listBen");var e=1;console.log(i),d(s,m(e,i.items[2].data.data),".book-srtong"),i.items[5].data.data.map(function(t){t.title=t.data.title,t.cover=t.data.cover,t.fiction_id=t.data.fiction_id}),d(l,m(e,i.items[3].data.data),".book-girl"),d(l,m(e,i.items[4].data.data),".book-boy"),d(c,i.items[5],".limited-time"),d(r,i.items[6],".book-topics"),h(".left"),o(".book-btn-strong").on("click",function(){e++;var t=o(this).attr("data");i.items[t];e%=5;var a=o(this).parent().prev().attr("class");d(2==t?s:l,m(e,i.items[t].data.data),"."+a)})}}),o.ajax({url:"api/bookself",dataType:"json",success:function(t){d(i,t.items,".book-right-city"),o(".right-book").on("click",function(){o(this).toggleClass("active"),o(this).hasClass("active")?d(i,t.items,".book-right-city"):d(l,t.items,".book-right-city")})}});var e=0;function h(t){if(3<=e)return o(".loging").html("暂无更多数据"),!1;var i=o(t).height();o(t).on("scroll",function(){var t,a=o(this).children().height()-i;o(this).scrollTop()+60>=a&&(o(this).off("scroll"),t=++e,o.ajax({url:"/api/loadmore",data:{pagenum:t,limit:20},dataType:"json",success:function(t){d(l,t.items,".log-cont",1),h(".left")}}))})}});